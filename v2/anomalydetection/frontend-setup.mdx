---
sidebar_position: 2
title: Frontend Setup
hide_title: true
---

# Setting up the Frontend

Setting up the frontend is relatively simple. You need to generate a request ID for each authentication event attempt. 

:::important
This frontend setup is required only for bot detection and anomaly IP based detection such as impossible travel detection. We also recommend checking for bot detection only on the email password login flows. 
:::

### Generating a Request ID on the Frontend

In order to generate a request ID, you need to import and initialise the SDK using your public API key. This SDK is used to generate a unique request ID for each authentication event attempt.

Below is an example of how to implement request ID generation on your frontend:


```tsx
const API_KEY = "<api-key>"; // Your public API key that you received from the SuperTokens team
const SDK_URL = "https://supertokens.io/JfNbWqtXUiGYuTqb/PYmK3PIPqdvHw6iz";

const supertokensDeviceIdPromise = require(SDK_URL + "?apiKey=" + API_KEY).then((RequestId: any) => RequestId.load({
    endpoint: [
        SDK_URL,
        DeviceId.defaultEndpoint
    ]
}));

async function getRequestId() {
    const deviceId = await supertokensDeviceIdPromise;
    const result = await deviceId.get();
    return result.requestId;
}
```

### Passing the Request ID to the Backend

Once you have generated the request ID on the frontend, you need to pass it to the backend. This is done by including the `requestId` property along with the value as part of the preAPIHook body from the initialisation of the recipes.

:::important
If the request ID is not passed to the backend, the anomaly detection will only be able to detect password breaches and brute force attacks.
:::

```tsx
const preAPIHook = async (context) => {
    let url = context.url;
    let requestInit = context.requestInit;

    let action = context.action;
    
    let requestId = await getRequestId();
    let body = context.requestInit.body;
    if (body !== undefined) {
        let bodyJson = JSON.parse(body as string);
        
        bodyJson.requestId = requestId;
        
        requestInit.body = JSON.stringify(bodyJson);
    }
    
    return {
        requestInit, url
    };
}
```

Below is a full example of how to configure the SDK and pass the request ID to the backend:
```tsx
import EmailPassword from "supertokens-auth-react/recipe/emailpassword";

const API_KEY = "<api-key>"; // Your public API key that you received from the SuperTokens team
const SDK_URL = "https://supertokens.io/JfNbWqtXUiGYuTqb/PYmK3PIPqdvHw6iz";

const supertokensDeviceIdPromise = require(SDK_URL + "?apiKey=" + API_KEY).then((DeviceId: any) => DeviceId.load({
    endpoint: [
        SDK_URL,
        DeviceId.defaultEndpoint
    ]
}));

async function getRequestId() {
    const deviceId = await supertokensDeviceIdPromise;
    const result = await deviceId.get();
    return result.requestId;
}

export const SuperTokensConfig = {
    // ... other config options
    appInfo: {
        appName: "SuperTokens Demo App",
        apiDomain: 'your-api-domain.com',
        websiteDomain: 'your-website-domain.com',
    },
    // recipeList contains all the modules that you want to
    // use from SuperTokens. See the full list here: https://supertokens.com/docs/guides
    recipeList: [
        EmailPassword.init({
            // highlight-start
            override: {
                functions: (originalImplementation) => {
                    return {
                        ...originalImplementation,
                        
                        // we will only be overriding what happens when a user
                        // clicks the sign in button.
                        signIn: async function (input) {
                            // TODO: some custom logic
                            let requestId = await getRequestId();
                            // or call the default behaviour as show below
                            return originalImplementation.signIn({ ...input, requestId });
                        },
                        // ...
                        // TODO: override more functions
                    }
                }
            }
            // highlight-end
        }),
    ],
};
```